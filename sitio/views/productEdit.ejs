<!--head-->
<%- include('./partials/head' , {title:'Editar producto'}) %> 
<body class="bg-light">
  <!--HEADER-->
  <%- include('./partials/headerAdmin') %> 
    
<main class="container">
    <div class="row">
        <div class="col-12 col-md-10 col-lg-8 mt-5 mx-auto">
            <div class="card p-4">
                <div class="card-header bg-info"> 
                     <h2>Editar producto</h2>
                </div>
                <div>
                  <img id="img-product" class="w-100" src="/images/products/<%= product.image %>" alt="">
                </div>
              <div class="card-body">                           
                    <form action="/products/update/<%= product.id %>?_method=PUT" class="row" method="POST" enctype="multipart/form-data" id="form-product">

                      <div class="row" >
                          <div class="col-12"> 
                              <div class="form-floating mb-3 ">
                        <input type="text" class="form-control <%= locals.errors && errors.name ? 'is-invalid' : null %>" id="name" placeholder="Nombre de producto" name="name" value="<%= product.name %>">
                        <label for="name">Nombre de producto</label>
                      </div>
                      <span class="text-danger small ms-2"><%= locals.errors && errors.name ? errors.name.msg : null%> </span>
                      <span id="nameError" class="text-danger small ms-2"><%= locals.errors && errors.name ? errors.name.msg : null%> </span>

                    </div>
                      <div class="col-12">
                          <div class="form-floating mb-3">
                        <textarea  class="form-control  <%= locals.errors && errors.description ? 'is-invalid' : null %>" name="description" style="resize: none; height: 100px" placeholder="Descripción de producto" id="floatingTextarea"><%= product.description %></textarea>
                        <label for="floatingTextarea">  Descripción </label>
                    </div>
                    <span class="text-danger small ms-2"><%= locals.errors && errors.description ? errors.description.msg : null%> </span>
                    <span id="descriptionError" class="text-danger small ms-2"><%= locals.errors && errors.description ? errors.description.msg : null%> </span>

                        <div class="form-floating col-md-6 mb-3">
                        <input name="price" type="number" class="form-control  <%= locals.errors && errors.price ? 'is-invalid' : null %>" id="price" value= "<%= product.price %>" >
                        <label for="price">Precio</label>
                      </div>
                      <span class="text-danger small ms-2"><%= locals.errors && errors.price ? errors.price.msg : null%> </span>
                      <span id="priceError" class="text-danger small ms-2"><%= locals.errors && errors.price ? errors.price.msg : null%> </span>

                    </div>
                    <div class="col-12 col-md-6">
                        <div class="form-floating col-md-6 mb-3">
                        <input class="form-control  <%= locals.errors && errors.discount ? 'is-invalid' : null %>" name="discount" type="number" id="discount" value= "<%= product.discount %>">
                        <label for="discount">Descuento</label>
                      </div>
                      <span class="text-danger small ms-2"><%= locals.errors && errors.discount ? errors.discount.msg : null%> </span>
                    </div>
                         
                      <div class="col-12 col-md-6">
                        <div class="form-floating">
                          <select class="form-select <%= locals.errors && errors.category ? 'is-invalid' : null %>" id="category" aria-label="Floating label select example" name="category">
                            <option value="" selected hidden>Elegí la categoría</option>
                            <% categories.forEach(category => { %>
                             <option value="<%= category.id %>" <%= locals.old && old.category.id === category.id  ? 'selected' : category.id == product.categoryId ? 'selected' : null %> > <%= category.name %>  </option>
                            <% }) %>
                          </select>
                          <label for="category">Categoría</label>
                        </div>
                        <span class="text-danger small ms-2"><%= locals.errors && errors.category ? errors.category.msg : null%> </span>
                      </div>
                      <div class="col-12 col-md-6">
                        <div class="mb-3 ">
                          <label id="btnImagen" for="image" class="btn btn-outline-info w-100 ">Subir imagen</label>
                          <input name="image" hidden class="form-control" type="file" id="image">
                          <span id="imageError" class="text-danger small ms-2"><%= locals.errors && errors.image ? errors.image.msg : null%> </span>
                        </div>
                      </div>
                      
                  <div class="col-12 mt-3"> 
                    <button type="submit" class="btn btn-outline-info ">Guardar</button> </div>
               
                    </div>
                
                    
              </form>
              </div>
            
        </div>
    </div>
        
    </div>
    
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
<script src="/javascript/productAddValidator.js"></script>
</body>
</html>